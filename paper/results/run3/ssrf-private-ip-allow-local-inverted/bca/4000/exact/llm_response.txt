```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    if not location:
        raise ValueError('Redirect response missing Location header')
    current_url = resolve_redirect_url(current_url, location)
    continue
REPLACE:
    if not location:
        raise ValueError('Redirect response missing Location header')
    current_url = resolve_redirect_url(current_url, location)
    continue
```
```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    if resolved.is_https:
        extensions['sni_hostname'] = resolved.hostname
REPLACE:
    if resolved.is_https:
        extensions['sni_hostname'] = resolved.hostname
```
```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    return ip_str in _CLOUD_METADATA_IPS
REPLACE:
    return ip_str in _CLOUD_METADATA_IPS
```
```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    if not allow_local and is_private_ip(resolved.resolved_ip):
REPLACE:
    if allow_local and is_private_ip(resolved.resolved_ip):
```