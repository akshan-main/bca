FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    if not location:
        raise ValueError('Redirect response missing Location header')
REPLACE:
    if location is None or not location.startswith(('http://', 'https://')):
        raise ValueError('Redirect response missing Location header or invalid URL')

FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    if not allow_local:
REPLACE:
    if allow_local:
