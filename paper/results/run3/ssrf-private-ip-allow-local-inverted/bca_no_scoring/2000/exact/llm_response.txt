```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    3. Validates that no resolved IP is private (unless allow_local=True)
REPLACE:
    3. Validates that no resolved IP is private (unless allow_local=False)
```
```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
        # Check if we need to follow a redirect
REPLACE:
        # Check if we need to follow a redirect and validate private IPs
```
```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
            if not location:
REPLACE:
            if not location or (not allow_local and is_cloud_metadata_ip(resolved_ip)):
```