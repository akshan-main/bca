```
FILE: tests/test_ssrf.py
SEARCH:
            assert resolved.resolved_ip == '192.168.1.1'
REPLACE:
            assert resolved.resolved_ip == '192.168.1.1' if allow_local else pytest.fail('Access to private/internal IP address')

FILE: tests/test_ssrf.py
SEARCH:
                await validate_and_resolve_url('http://internal.local/path', allow_local=False)
REPLACE:
                await validate_and_resolve_url('http://internal.local/path', allow_local=True)

FILE: tests/test_ssrf.py
SEARCH:
                await validate_and_resolve_url('http://metadata.google.internal/path', allow_local=True)
REPLACE:
                await validate_and_resolve_url('http://metadata.google.internal/path', allow_local=False)

FILE: tests/test_ssrf.py
SEARCH:
                await validate_and_resolve_url('http://metadata.aliyun.internal/path', allow_local=True)
REPLACE:
                await validate_and_resolve_url('http://metadata.aliyun.internal/path', allow_local=False)

FILE: tests/test_ssrf.py
SEARCH:
                await validate_and_resolve_url('http://192.168.1.1/path', allow_local=False)
REPLACE:
                await validate_and_resolve_url('http://192.168.1.1/path', allow_local=True)

FILE: tests/test_ssrf.py
SEARCH:
                await validate_and_resolve_url('http://example.com/path', allow_local=False)
REPLACE:
                await validate_and_resolve_url('http://example.com/path', allow_local=True)

FILE: tests/test_ssrf.py
SEARCH:
                await validate_and_resolve_url('http://attacker.com/path', allow_local=False)
REPLACE:
                await validate_and_resolve_url('http://attacker.com/path', allow_local=True)

FILE: tests/test_ssrf.py
SEARCH:
                await validate_and_resolve_url('http://attacker.com/path', allow_local=False)
REPLACE:
                await validate_and_resolve_url('http://attacker.com/path', allow_local=True)
```