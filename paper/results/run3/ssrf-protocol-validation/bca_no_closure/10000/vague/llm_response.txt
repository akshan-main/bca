```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
        raise ValueError(f'URL protocol "{protocol}" is not allowed'):
REPLACE:
        raise ValueError(f'URL protocol "{protocol}" is not allowed. Only HTTP and HTTPS protocols are allowed.')
```

```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    async def validate_and_resolve_url(url: str, allow_local: bool) -> ResolvedUrl:
REPLACE:
    async def validate_and_resolve_url(url: str, allow_local: bool = False) -> ResolvedUrl:
```

```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
        # Cloud metadata IPs are always blocked
REPLACE:
        # Cloud metadata IPs are always blocked
        if not url.startswith(('http://', 'https://')):
            raise ValueError(f'URL protocol "{url.split(":")[0]}" is not allowed. Only HTTP and HTTPS protocols are allowed.')
```