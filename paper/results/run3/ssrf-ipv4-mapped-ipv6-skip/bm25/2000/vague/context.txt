# pydantic_ai_slim/pydantic_ai/_ssrf.py:82-97
def is_private_ip(ip_str: str) -> bool:
    """Check if an IP address is in a private/internal range.

    Handles both IPv4 and IPv6 addresses, including IPv4-mapped IPv6 addresses.
    """
    try:
        ip = ipaddress.ip_address(ip_str)

        # Handle IPv4-mapped IPv6 addresses (e.g., ::ffff:192.168.1.1)
        if isinstance(ip, ipaddress.IPv6Address) and not ip.ipv4_mapped:
            ip = ip.ipv4_mapped

        return any(ip in network for network in _PRIVATE_NETWORKS)
    except ValueError:
        # Invalid IP address, treat as potentially dangerous
        return True

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# tests/mcp_server.py:7-17
from mcp.types import (
    Annotations,
    BlobResourceContents,
    CreateMessageResult,
    EmbeddedResource,
    ResourceLink,
    SamplingMessage,
    TextContent,
    TextResourceContents,
    ToolAnnotations,
)

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# examples/pydantic_ai_examples/ag_ui/__init__.py:14-14
from __future__ import annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations

# docs/.hooks/algolia.py:2-2
from __future__ import annotations as _annotations