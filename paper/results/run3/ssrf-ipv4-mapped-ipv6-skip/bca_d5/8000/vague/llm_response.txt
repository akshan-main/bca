```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    async def test_6to4_address_blocked(self) -> None:
        """Test that 6to4 addresses (which can embed private IPv4) are blocked."""
        # 2002:c0a8:0101::1 embeds 192.168.1.1
        with pytest.raises(ValueError, match='Access to private/internal IP address'):
            await validate_and_resolve_url('http://[2002:c0a8:0101::1]/path', allow_local=False)
REPLACE:
    async def test_ipv6_private_address_blocked(self) -> None:
        """Test that private IPv4 addresses in IPv6 notation are blocked."""
        # ::ffff:192.168.1.1 embeds 192.168.1.1
        with pytest.raises(ValueError, match='Access to private/internal IP address'):
            await validate_and_resolve_url('http://[::ffff:192.168.1.1]/path', allow_local=False)
```