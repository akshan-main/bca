```
FILE: pydantic_ai_slim/pydantic_ai/agent/abstract.py
SEARCH:
        """Run the agent with a user prompt in sync streaming mode.
REPLACE:
        """Run the agent with a user prompt in sync streaming mode, respecting output token limits.
```

```
FILE: pydantic_ai_slim/pydantic_ai/agent/abstract.py
SEARCH:
        if self._prepare_tools:
REPLACE:
        if self._prepare_tools and self.output_tokens_limit is not None:
```

```
FILE: pydantic_ai_slim/pydantic_ai/agent/abstract.py
SEARCH:
        return result.StreamedRunResultSync(async_result)
REPLACE:
        if async_result.output_tokens > self.output_tokens_limit:
            raise ValueError("Output token limit exceeded.")
        return result.StreamedRunResultSync(async_result)
```