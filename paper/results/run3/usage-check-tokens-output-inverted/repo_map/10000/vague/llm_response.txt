```
FILE: pydantic_ai_slim/pydantic_ai/agent/__init__.py
SEARCH:
        # Build the graph
        graph = _agent_graph.build_agent_graph(self.name, self._deps_type, output_type_)
        
        # Build the initial state
        usage = usage or _usage.RunUsage()
REPLACE:
        # Build the graph
        graph = _agent_graph.build_agent_graph(self.name, self._deps_type, output_type_)
        
        # Apply output token limits
        if usage_limits.output_tokens is not None:
            self._max_output_tokens = usage_limits.output_tokens
        
        # Build the initial state
        usage = usage or _usage.RunUsage()
```
```
FILE: pydantic_ai_slim/pydantic_ai/agent/abstract.py
SEARCH:
        raise NotImplementedError
        yield
REPLACE:
        if usage_limits.output_tokens is not None:
            self._max_output_tokens = usage_limits.output_tokens
        raise NotImplementedError
        yield
```
```
FILE: pydantic_ai_slim/pydantic_ai/agent/wrapper.py
SEARCH:
        async with self.wrapped.iter(
REPLACE:
        async with self.wrapped.iter(
            usage_limits=usage_limits,
```
```
FILE: pydantic_ai_slim/pydantic_ai/durable_exec/dbos/_agent.py
SEARCH:
                yield run
REPLACE:
                if usage_limits.output_tokens is not None:
                    self._max_output_tokens = usage_limits.output_tokens
                yield run
```
```
FILE: pydantic_ai_slim/pydantic_ai/durable_exec/prefect/_agent.py
SEARCH:
                yield run
REPLACE:
                if usage_limits.output_tokens is not None:
                    self._max_output_tokens = usage_limits.output_tokens
                yield run
```