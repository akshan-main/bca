FILE: pydantic_ai_slim/pydantic_ai/agent/__init__.py
SEARCH:
        # Build the graph
        graph = _agent_graph.build_agent_graph(self.name, self._deps_type, output_type_)
        
        # Build the initial state
        usage = usage or _usage.RunUsage()
REPLACE:
        # Build the graph
        graph = _agent_graph.build_agent_graph(self.name, self._deps_type, output_type_)
        
        # Build the initial state
        usage = usage or _usage.RunUsage()
        if usage_limits is not None:
            usage.limits = usage_limits

FILE: pydantic_ai_slim/pydantic_ai/agent/abstract.py
SEARCH:
        raise NotImplementedError
        yield
REPLACE:
        if usage_limits is not None:
            usage.limits = usage_limits
        raise NotImplementedError
        yield

FILE: pydantic_ai_slim/pydantic_ai/agent/wrapper.py
SEARCH:
        async with self.wrapped.iter(
REPLACE:
        async with self.wrapped.iter(
            usage_limits=usage_limits,

FILE: pydantic_ai_slim/pydantic_ai/durable_exec/prefect/_agent.py
SEARCH:
        with self._prefect_overrides():
REPLACE:
        with self._prefect_overrides():
            if usage_limits is not None:
                self.usage_limits = usage_limits
