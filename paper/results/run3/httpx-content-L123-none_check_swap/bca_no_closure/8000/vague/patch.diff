FILE: httpx/_client.py
SEARCH:
    def __init__(self, func: typing.Callable[[Request], Request]) -> None:
        self._func = func
REPLACE:
    def __init__(self, func: typing.Callable[[Request], Request] = None) -> None:
        self._func = func if func is not None else default_func

FILE: httpx/_client.py
SEARCH:
    def close(self) -> None:
        elapsed = time.perf_counter() - self._start
        self._response.elapsed = datetime.timedelta(seconds=elapsed)
        self._stream.close()
REPLACE:
    def close(self) -> None:
        if self._stream is not None:
            elapsed = time.perf_counter() - self._start
            self._response.elapsed = datetime.timedelta(seconds=elapsed)
            self._stream.close()

FILE: httpx/_client.py
SEARCH:
    async def aclose(self) -> None:
        elapsed = time.perf_counter() - self._start
        self._response.elapsed = datetime.timedelta(seconds=elapsed)
        await self._stream.aclose()
REPLACE:
    async def aclose(self) -> None:
        if self._stream is not None:
            elapsed = time.perf_counter() - self._start
            self._response.elapsed = datetime.timedelta(seconds=elapsed)
            await self._stream.aclose()
