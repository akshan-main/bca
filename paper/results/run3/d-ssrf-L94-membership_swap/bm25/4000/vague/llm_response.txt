```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (name_equals := query.get('name_equals')) and self.name != name_equals:
REPLACE:
        if (name_equals := query.get('name_equals')) and self.name != name_equals and name_equals is not None:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (name_contains := query.get('name_contains')) and name_contains not in self.name:
REPLACE:
        if (name_contains := query.get('name_contains')) and name_contains is not None and name_contains not in self.name:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (name_matches_regex := query.get('name_matches_regex')) and not re.match(name_matches_regex, self.name):
REPLACE:
        if (name_matches_regex := query.get('name_matches_regex')) and name_matches_regex is not None and not re.match(name_matches_regex, self.name):
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (has_attributes := query.get('has_attributes')) and not all(
REPLACE:
        if (has_attributes := query.get('has_attributes')) is not None and not all(
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (has_attributes_keys := query.get('has_attribute_keys')) and not all(
REPLACE:
        if (has_attributes_keys := query.get('has_attribute_keys')) is not None and not all(
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (min_duration := query.get('min_duration')) is not None:
REPLACE:
        if (min_duration := query.get('min_duration')) is not None and min_duration >= 0:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (max_duration := query.get('max_duration')) is not None:
REPLACE:
        if (max_duration := query.get('max_duration')) is not None and max_duration >= 0:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (min_child_count := query.get('min_child_count')) and len(self.children) < min_child_count:
REPLACE:
        if (min_child_count := query.get('min_child_count')) is not None and len(self.children) < min_child_count:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (max_child_count := query.get('max_child_count')) and len(self.children) > max_child_count:
REPLACE:
        if (max_child_count := query.get('max_child_count')) is not None and len(self.children) > max_child_count:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (min_descendant_count := query.get('min_descendant_count')) and len(descendants()) < min_descendant_count:
REPLACE:
        if (min_descendant_count := query.get('min_descendant_count')) is not None and len(descendants()) < min_descendant_count:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (max_descendant_count := query.get('max_descendant_count')) and len(descendants()) > max_descendant_count:
REPLACE:
        if (max_descendant_count := query.get('max_descendant_count')) is not None and len(descendants()) > max_descendant_count:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (some_descendant_has := query.get('some_descendant_has')) and not any(
REPLACE:
        if (some_descendant_has := query.get('some_descendant_has')) is not None and not any(
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (all_descendants_have := query.get('all_descendants_have')) and not all(
REPLACE:
        if (all_descendants_have := query.get('all_descendants_have')) is not None and not all(
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (no_descendant_has := query.get('no_descendant_has')) and any(
REPLACE:
        if (no_descendant_has := query.get('no_descendant_has')) is not None and any(
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (min_depth := query.get('min_depth')) and len(ancestors()) < min_depth:
REPLACE:
        if (min_depth := query.get('min_depth')) is not None and len(ancestors()) < min_depth:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (max_depth := query.get('max_depth')) and len(ancestors()) > max_depth:
REPLACE:
        if (max_depth := query.get('max_depth')) is not None and len(ancestors()) > max_depth:
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (some_ancestor_has := query.get('some_ancestor_has')) and not any(
REPLACE:
        if (some_ancestor_has := query.get('some_ancestor_has')) is not None and not any(
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (all_ancestors_have := query.get('all_ancestors_have')) and not all(
REPLACE:
        if (all_ancestors_have := query.get('all_ancestors_have')) is not None and not all(
```

```
FILE: pydantic_evals/pydantic_evals/otel/span_tree.py
SEARCH:
        if (no_ancestor_has := query.get('no_ancestor_has')) and any(
REPLACE:
        if (no_ancestor_has := query.get('no_ancestor_has')) is not None and any(
```