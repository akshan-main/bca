# pydantic_ai_slim/pydantic_ai/_ssrf.py:23-37
_PRIVATE_NETWORKS: tuple[ipaddress.IPv4Network | ipaddress.IPv6Network, ...] = (
    # IPv4 private ranges
    ipaddress.IPv4Network('127.0.0.0/8'),  # Loopback
    ipaddress.IPv4Network('10.0.0.0/8'),  # Private
    ipaddress.IPv4Network('172.16.0.0/12'),  # Private
    ipaddress.IPv4Network('192.168.0.0/16'),  # Private
    ipaddress.IPv4Network('169.254.0.0/16'),  # Link-local (includes cloud metadata)
    ipaddress.IPv4Network('0.0.0.0/8'),  # "This" network
    ipaddress.IPv4Network('100.64.0.0/10'),  # CGNAT (RFC 6598), includes Alibaba Cloud metadata
    # IPv6 private ranges
    ipaddress.IPv6Network('::1/128'),  # Loopback
    ipaddress.IPv6Network('fe80::/10'),  # Link-local
    ipaddress.IPv6Network('fc00::/7'),  # Unique local address
    ipaddress.IPv6Network('2002::/16'),  # 6to4 (can embed private IPv4 addresses)
)

# pydantic_ai_slim/pydantic_ai/toolsets/abstract.py:105-110
    async def __aexit__(self, *args: Any) -> bool | None:
        """Exit the toolset context.

        This is where you can tear down network connections in a concrete implementation.
        """
        return None

# pydantic_ai_slim/pydantic_ai/toolsets/abstract.py:98-103
    async def __aenter__(self) -> Self:
        """Enter the toolset context.

        This is where you can set up network connections in a concrete implementation.
        """
        return self

# pydantic_ai_slim/pydantic_ai/models/__init__.py:867-916
    def _get_instructions(
        messages: Sequence[ModelMessage], model_request_parameters: ModelRequestParameters | None = None
    ) -> str | None:
        """Get instructions from the first ModelRequest found when iterating messages in reverse.

        In the case that a "mock" request was generated to include a tool-return part for a result tool,
        we want to use the instructions from the second-to-most-recent request (which should correspond to the
        original request that generated the response that resulted in the tool-return part).
        """
        instructions = None

        last_two_requests: list[ModelRequest] = []
        for message in reversed(messages):
            if isinstance(message, ModelRequest):
                last_two_requests.append(message)
                if len(last_two_requests) == 2:
                    break
                if message.instructions is not None:
                    instructions = message.instructions
                    break

        # If we don't have two requests, and we didn't already return instructions, there are definitely not any:
        if instructions is None and len(last_two_requests) == 2:
            most_recent_request = last_two_requests[0]
            second_most_recent_request = last_two_requests[1]

            # If we've gotten this far and the most recent request consists of only tool-return parts or retry-prompt parts,
            # we use the instructions from the second-to-most-recent request. This is necessary because when handling
            # result tools, we generate a "mock" ModelRequest with a tool-return part for it, and that ModelRequest will not
            # have the relevant instructions from the agent.

            # While it's possible that you could have a message history where the most recent request has only tool returns,
            # I believe there is no way to achieve that would _change_ the instructions without manually crafting the most
            # recent message. That might make sense in principle for some usage pattern, but it's enough of an edge case
            # that I think it's not worth worrying about, since you can work around this by inserting another ModelRequest
            # with no parts at all immediately before the request that has the tool calls (that works because we only look
            # at the two most recent ModelRequests here).

            # If you have a use case where this causes pain, please open a GitHub issue and we can discuss alternatives.

            if all(p.part_kind == 'tool-return' or p.part_kind == 'retry-prompt' for p in most_recent_request.parts):
                instructions = second_most_recent_request.instructions

        if model_request_parameters and (output_instructions := model_request_parameters.prompted_output_instructions):
            if instructions:
                instructions = '\n\n'.join([instructions, output_instructions])
            else:
                instructions = output_instructions

        return instructions

# examples/pydantic_ai_examples/ag_ui/api/agentic_generative_ui.py:6-6
from typing import Any, Literal

# examples/pydantic_ai_examples/chat_app.py:20-20
from typing import Annotated, Any, Literal, TypeVar

# examples/pydantic_ai_examples/slack_lead_qualifier/app.py:1-1
from typing import Any

# examples/pydantic_ai_examples/slack_lead_qualifier/modal.py:1-1
from typing import Any

# examples/pydantic_ai_examples/slack_lead_qualifier/models.py:1-1
from typing import Annotated, Any

# examples/pydantic_ai_examples/slack_lead_qualifier/slack.py:2-2
from typing import Any

# examples/pydantic_ai_examples/sql_gen.py:19-19
from typing import Annotated, Any, TypeAlias

# examples/pydantic_ai_examples/weather_agent.py:16-16
from typing import Any

# pydantic_ai_slim/pydantic_ai/_a2a.py:9-9
from typing import Any, Generic, TypeVar

# pydantic_ai_slim/pydantic_ai/_agent_graph.py:14-14
from typing import TYPE_CHECKING, Any, Generic, Literal, TypeGuard, cast

# pydantic_ai_slim/pydantic_ai/_cli/__init__.py:11-11
from typing import Any

# pydantic_ai_slim/pydantic_ai/_function_schema.py:12-12
from typing import TYPE_CHECKING, Any, Concatenate, cast, get_origin

# pydantic_ai_slim/pydantic_ai/_griffe.py:8-8
from typing import TYPE_CHECKING, Any, Literal, cast

# pydantic_ai_slim/pydantic_ai/_json_schema.py:7-7
from typing import Any, Literal

# pydantic_ai_slim/pydantic_ai/_output.py:9-9
from typing import TYPE_CHECKING, Any, Generic, Literal, cast, overload

# pydantic_ai_slim/pydantic_ai/_parts_manager.py:18-18
from typing import Any, TypeVar

# pydantic_ai_slim/pydantic_ai/_run_context.py:8-8
from typing import TYPE_CHECKING, Any, Generic

# pydantic_ai_slim/pydantic_ai/_system_prompt.py:6-6
from typing import Any, Generic, cast

# pydantic_ai_slim/pydantic_ai/_tool_manager.py:8-8
from typing import Any, Generic, Literal

# pydantic_ai_slim/pydantic_ai/_utils.py:16-26
from typing import (
    TYPE_CHECKING,
    Any,
    Generic,
    TypeAlias,
    TypeGuard,
    TypeVar,
    get_args,
    get_origin,
    overload,
)

# pydantic_ai_slim/pydantic_ai/ag_ui.py:12-12
from typing import Any

# pydantic_ai_slim/pydantic_ai/agent/__init__.py:12-12
from typing import TYPE_CHECKING, Any, ClassVar, overload

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:9-9
from typing import TYPE_CHECKING, Any, Generic, TypeAlias, cast, overload

# pydantic_ai_slim/pydantic_ai/agent/wrapper.py:5-5
from typing import Any, overload

# pydantic_ai_slim/pydantic_ai/builtin_tools.py:6-6
from typing import Annotated, Any, Literal, Union

# pydantic_ai_slim/pydantic_ai/common_tools/duckduckgo.py:6-6
from typing_extensions import Any, TypedDict

# pydantic_ai_slim/pydantic_ai/common_tools/exa.py:11-11
from typing_extensions import Any, TypedDict

# pydantic_ai_slim/pydantic_ai/common_tools/tavily.py:5-5
from typing_extensions import Any, TypedDict

# pydantic_ai_slim/pydantic_ai/durable_exec/dbos/_agent.py:5-5
from typing import Any, Literal, cast, overload

# pydantic_ai_slim/pydantic_ai/durable_exec/dbos/_mcp.py:5-5
from typing import TYPE_CHECKING, Any

# pydantic_ai_slim/pydantic_ai/durable_exec/dbos/_model.py:6-6
from typing import Any

# pydantic_ai_slim/pydantic_ai/durable_exec/prefect/_agent.py:6-6
from typing import Any, overload

# pydantic_ai_slim/pydantic_ai/durable_exec/prefect/_cache_policies.py:2-2
from typing import Any, TypeGuard

# pydantic_ai_slim/pydantic_ai/durable_exec/prefect/_function_toolset.py:3-3
from typing import Any

# pydantic_ai_slim/pydantic_ai/durable_exec/prefect/_mcp_server.py:4-4
from typing import TYPE_CHECKING, Any

# pydantic_ai_slim/pydantic_ai/durable_exec/prefect/_model.py:6-6
from typing import Any

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/__init__.py:6-6
from typing import Any

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/_agent.py:8-8
from typing import Any, Literal, overload

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/_dynamic_toolset.py:5-5
from typing import Any, Literal

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/_function_toolset.py:4-4
from typing import Any, Literal

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/_mcp.py:5-5
from typing import Any, Literal

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/_model.py:9-9
from typing import Any, cast

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/_run_context.py:3-3
from typing import Any

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/_toolset.py:6-6
from typing import Annotated, Any, Literal

# pydantic_ai_slim/pydantic_ai/durable_exec/temporal/_workflow.py:2-2
from typing import Any

# pydantic_ai_slim/pydantic_ai/embeddings/__init__.py:5-5
from typing import Any, ClassVar, Literal, get_args

# pydantic_ai_slim/pydantic_ai/embeddings/bedrock.py:9-9
from typing import TYPE_CHECKING, Any, Literal, cast

# pydantic_ai_slim/pydantic_ai/embeddings/cohere.py:3-3
from typing import Any, Literal, cast

# pydantic_ai_slim/pydantic_ai/embeddings/instrumented.py:8-8
from typing import Any

# pydantic_ai_slim/pydantic_ai/embeddings/result.py:4-4
from typing import Any, Literal

# pydantic_ai_slim/pydantic_ai/embeddings/sentence_transformers.py:6-6
from typing import Any, cast

# pydantic_ai_slim/pydantic_ai/exceptions.py:5-5
from typing import TYPE_CHECKING, Any

# pydantic_ai_slim/pydantic_ai/ext/aci.py:4-4
from typing import Any

# pydantic_ai_slim/pydantic_ai/ext/langchain.py:3-3
from typing import Any, Protocol

# pydantic_ai_slim/pydantic_ai/format_prompt.py:8-8
from typing import Any, Literal

# pydantic_ai_slim/pydantic_ai/mcp.py:14-14
from typing import Annotated, Any, overload

# pydantic_ai_slim/pydantic_ai/messages.py:14-14
from typing import TYPE_CHECKING, Annotated, Any, Literal, TypeAlias, cast, overload

# pydantic_ai_slim/pydantic_ai/models/__init__.py:17-17
from typing import Any, Generic, Literal, TypeVar, get_args, overload

# pydantic_ai_slim/pydantic_ai/models/anthropic.py:8-8
from typing import Any, Literal, cast, overload

# pydantic_ai_slim/pydantic_ai/models/bedrock.py:10-10
from typing import TYPE_CHECKING, Any, Generic, Literal, cast, overload

# pydantic_ai_slim/pydantic_ai/models/cerebras.py:6-6
from typing import Any, Literal, cast

# pydantic_ai_slim/pydantic_ai/models/concurrency.py:8-8
from typing import Any

# pydantic_ai_slim/pydantic_ai/models/fallback.py:7-7
from typing import TYPE_CHECKING, Any

# pydantic_ai_slim/pydantic_ai/models/function.py:10-10
from typing import Any, TypeAlias

# pydantic_ai_slim/pydantic_ai/models/gemini.py:16-16
from typing import Annotated, Any, Literal, Protocol, cast

# pydantic_ai_slim/pydantic_ai/models/google.py:9-9
from typing import Any, Literal, cast, overload

# pydantic_ai_slim/pydantic_ai/models/groq.py:7-7
from typing import Any, Literal, cast, overload

# pydantic_ai_slim/pydantic_ai/models/huggingface.py:7-7
from typing import Any, Literal, cast, overload

# pydantic_ai_slim/pydantic_ai/models/instrumented.py:9-9
from typing import Any, Literal, cast

# pydantic_ai_slim/pydantic_ai/models/mcp_sampling.py:6-6
from typing import TYPE_CHECKING, Any, cast

# pydantic_ai_slim/pydantic_ai/models/mistral.py:7-7
from typing import Any, Literal, cast

# pydantic_ai_slim/pydantic_ai/models/openai.py:12-12
from typing import Any, Literal, cast, overload

# pydantic_ai_slim/pydantic_ai/models/openrouter.py:5-5
from typing import Annotated, Any, Literal, TypeAlias, cast

# pydantic_ai_slim/pydantic_ai/models/outlines.py:13-13
from typing import TYPE_CHECKING, Any, Literal, cast

# pydantic_ai_slim/pydantic_ai/models/test.py:9-9
from typing import Any, Literal

# pydantic_ai_slim/pydantic_ai/models/wrapper.py:7-7
from typing import Any

# pydantic_ai_slim/pydantic_ai/models/xai.py:9-9
from typing import Any, Literal, cast

# pydantic_ai_slim/pydantic_ai/output.py:5-5
from typing import Any, Generic, Literal

# pydantic_ai_slim/pydantic_ai/profiles/openai.py:7-7
from typing import Any, Literal

# pydantic_ai_slim/pydantic_ai/providers/__init__.py:9-9
from typing import Any, Generic, TypeVar

# pydantic_ai_slim/pydantic_ai/providers/bedrock.py:7-7
from typing import Any, Literal, overload

# pydantic_ai_slim/pydantic_ai/providers/gateway.py:8-8
from typing import TYPE_CHECKING, Any, Literal, overload

# pydantic_ai_slim/pydantic_ai/providers/outlines.py:3-3
from typing import Any

# pydantic_ai_slim/pydantic_ai/providers/sentence_transformers.py:3-3
from typing import Any

# pydantic_ai_slim/pydantic_ai/result.py:7-7
from typing import TYPE_CHECKING, Any, Generic, cast, overload

# pydantic_ai_slim/pydantic_ai/retries.py:39-39
from typing import TYPE_CHECKING, Any, cast

# pydantic_ai_slim/pydantic_ai/run.py:7-7
from typing import TYPE_CHECKING, Any, Generic, Literal, overload

# pydantic_ai_slim/pydantic_ai/tools.py:5-5
from typing import Annotated, Any, Concatenate, Generic, Literal, TypeAlias, cast

# pydantic_ai_slim/pydantic_ai/toolsets/_dynamic.py:5-5
from typing import Any, TypeAlias

# pydantic_ai_slim/pydantic_ai/toolsets/abstract.py:6-6
from typing import TYPE_CHECKING, Any, Generic, Literal, Protocol

# pydantic_ai_slim/pydantic_ai/toolsets/approval_required.py:5-5
from typing import Any

# pydantic_ai_slim/pydantic_ai/toolsets/combined.py:8-8
from typing import Any

# pydantic_ai_slim/pydantic_ai/toolsets/external.py:4-4
from typing import Any

# pydantic_ai_slim/pydantic_ai/toolsets/fastmcp.py:8-8
from typing import TYPE_CHECKING, Any, Literal

# pydantic_ai_slim/pydantic_ai/toolsets/function.py:5-5
from typing import Any, overload

# pydantic_ai_slim/pydantic_ai/toolsets/prefixed.py:4-4
from typing import Any

# pydantic_ai_slim/pydantic_ai/toolsets/renamed.py:4-4
from typing import Any

# pydantic_ai_slim/pydantic_ai/toolsets/wrapper.py:5-5
from typing import Any

# pydantic_ai_slim/pydantic_ai/ui/_adapter.py:9-17
from typing import (
    TYPE_CHECKING,
    Any,
    ClassVar,
    Generic,
    Protocol,
    cast,
    runtime_checkable,
)

# pydantic_ai_slim/pydantic_ai/ui/_event_stream.py:7-7
from typing import TYPE_CHECKING, Any, Generic, Literal, TypeAlias, TypeVar, cast

# pydantic_ai_slim/pydantic_ai/ui/ag_ui/_adapter.py:8-12
from typing import (
    TYPE_CHECKING,
    Any,
    cast,
)