FILE: pydantic_ai_slim/pydantic_ai/usage.py
SEARCH:
    input_tokens: int = 0
REPLACE:
    input_tokens: int = 0  # Ensure this is initialized correctly to avoid negative counts

FILE: pydantic_ai_slim/pydantic_ai/result.py
SEARCH:
        return self._initial_run_ctx_usage + self._raw_stream_response.usage()
REPLACE:
        return self._initial_run_ctx_usage + self._raw_stream_response.usage() if self._raw_stream_response else self._initial_run_ctx_usage

FILE: pydantic_ai_slim/pydantic_ai/run.py
SEARCH:
        return self._graph_run.state.usage
REPLACE:
        return self._graph_run.state.usage if self._graph_run.state else RunUsage()
