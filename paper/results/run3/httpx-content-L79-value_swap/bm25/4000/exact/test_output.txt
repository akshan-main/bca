tform darwin -- Python 3.11.11, pytest-8.3.5, pluggy-1.5.0
rootdir: /Users/akshankrithick/projects/httpx
configfile: pyproject.toml
plugins: respx-0.22.0, mock-3.15.1, recording-0.13.4, xdist-3.8.0, timeout-2.4.0, order-1.3.0, anyio-4.8.0, rerunfailures-15.1, inline-snapshot-0.31.1, hypothesis-6.148.2, asyncio-1.3.0, rich-0.2.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 43 items

tests/test_content.py ....F

=================================== FAILURES ===================================
________________________ test_iterator_content[asyncio] ________________________

    @pytest.mark.anyio
    async def test_iterator_content():
        def hello_world() -> typing.Iterator[bytes]:
            yield b"Hello, "
            yield b"world!"
    
        request = httpx.Request(method, url, content=hello_world())
        assert isinstance(request.stream, typing.Iterable)
        assert not isinstance(request.stream, typing.AsyncIterable)
    
>       content = b"".join(list(request.stream))

tests/test_content.py:103: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <httpx._content.IteratorByteStream object at 0x105c92050>

    def __iter__(self) -> Iterator[bytes]:
        if self._is_stream_consumed and self._is_generator:
>           raise StreamConsumed()
E           httpx.StreamConsumed: Attempted to read or stream some content, but the content has already been streamed. For requests, this could be due to passing a generator as request content, and then receiving a redirect response or a secondary request as part of an authentication flow.For responses, this could be due to attempting to stream the response content more than once.

httpx/_content.py:52: StreamConsumed
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
========================= 1 failed, 4 passed in 0.18s ==========================

/Users/akshankrithick/anaconda3/envs/vvenv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:247: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))