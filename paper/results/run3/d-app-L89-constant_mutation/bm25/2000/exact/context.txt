# pydantic_ai_slim/pydantic_ai/messages.py:4-4
import hashlib

# pydantic_ai_slim/pydantic_ai/messages.py:4-4
import hashlib

# pydantic_ai_slim/pydantic_ai/messages.py:4-4
import hashlib

# pydantic_ai_slim/pydantic_ai/ui/vercel_ai/response_types.py:26-27
    def encode(self, sdk_version: int) -> str:
        return self.model_dump_json(by_alias=True, exclude_none=True)

# pydantic_ai_slim/pydantic_ai/ui/vercel_ai/response_types.py:256-257
    def encode(self, sdk_version: int) -> str:
        return '[DONE]'

# tests/test_temporal.py:3066-3069
    async def encode(
        self, payloads: Sequence[temporalio.api.common.v1.Payload]
    ) -> list[temporalio.api.common.v1.Payload]:  # pragma: no cover
        return list(payloads)

# pydantic_ai_slim/pydantic_ai/ui/vercel_ai/response_types.py:97-99
    def encode(self, sdk_version: int) -> str:
        exclude = {'provider_metadata'} if sdk_version < 6 else None
        return self.model_dump_json(by_alias=True, exclude_none=True, exclude=exclude)

# pydantic_ai_slim/pydantic_ai/ui/ag_ui/_event_stream.py:87-88
    def encode_event(self, event: BaseEvent) -> str:
        return self._event_encoder.encode(event)

# tests/test_ui.py:119-120
    def encode_event(self, event: str) -> str:
        return event

# pydantic_ai_slim/pydantic_ai/ui/ag_ui/_event_stream.py:80-81
    def _event_encoder(self) -> EventEncoder:
        return EventEncoder(accept=self.accept or SSE_CONTENT_TYPE)

# pydantic_ai_slim/pydantic_ai/ui/vercel_ai/_event_stream.py:90-91
    def encode_event(self, event: BaseChunk) -> str:
        return f'data: {event.encode(self.sdk_version)}\n\n'

# pydantic_ai_slim/pydantic_ai/ui/_event_stream.py:101-103
    def encode_event(self, event: EventT) -> str:
        """Encode a protocol-specific event as a string."""
        raise NotImplementedError

# tests/test_ui_web.py:521-526
def test_agent_to_web_with_html_source():
    """Test that Agent.to_web() accepts html_source parameter."""
    agent = Agent('test')
    app = agent.to_web(html_source='https://custom-cdn.example.com/ui/index.html')

    assert isinstance(app, Starlette)

# pydantic_ai_slim/pydantic_ai/ui/_event_stream.py:105-108
    async def encode_stream(self, stream: AsyncIterator[EventT]) -> AsyncIterator[str]:
        """Encode a stream of protocol-specific events as strings according to the `Accept` header value."""
        async for event in stream:
            yield self.encode_event(event)

# tests/test_cli.py:752-769
def test_clai_web_with_html_source(mocker: MockerFixture, env: TestEnv):
    """Test web command with --html-source flag."""
    env.set('OPENAI_API_KEY', 'test')
    mock_run_web = mocker.patch('pydantic_ai._cli.web.run_web_command', return_value=0)

    custom_url = 'https://internal.company.com/pydantic-ai-ui/index.html'
    assert cli(['web', '-m', 'openai:gpt-5', '--html-source', custom_url], prog_name='clai') == 0

    mock_run_web.assert_called_once_with(
        agent_path=None,
        host='127.0.0.1',
        port=7932,
        models=['openai:gpt-5'],
        tools=[],
        instructions=None,
        default_model='openai:gpt-5',
        html_source=custom_url,
    )

# pydantic_ai_slim/pydantic_ai/ui/_adapter.py:191-197
    def encode_stream(self, stream: AsyncIterator[EventT]) -> AsyncIterator[str]:
        """Encode a stream of protocol-specific events as strings according to the `Accept` header value.

        Args:
            stream: The stream of protocol-specific events to encode.
        """
        return self.build_event_stream().encode_stream(stream)

# tests/test_ui_web.py:575-583
def test_chat_app_index_file_not_found(tmp_path: Path):
    """Test that index endpoint raises FileNotFoundError for non-existent html_source file."""
    agent = Agent('test')
    nonexistent_file = tmp_path / 'nonexistent-ui.html'
    app = create_web_app(agent, html_source=str(nonexistent_file))

    with TestClient(app, raise_server_exceptions=True) as client:
        with pytest.raises(FileNotFoundError, match='Local UI file not found'):
            client.get('/')

# pydantic_ai_slim/pydantic_ai/messages.py:574-576
    def base64(self) -> str:
        """Return the binary data as a base64-encoded string. Default encoding is UTF-8."""
        return base64.b64encode(self.data).decode()

# tests/test_ui_web.py:566-572
async def test_get_ui_html_source_instance_not_found(monkeypatch: pytest.MonkeyPatch, tmp_path: Path):
    """Test that _get_ui_html raises FileNotFoundError for missing Path instances."""
    # Try to use a non-existent Path instance
    nonexistent_path = tmp_path / 'nonexistent-ui.html'

    with pytest.raises(FileNotFoundError, match='Local UI file not found'):
        await app_module._get_ui_html(html_source=nonexistent_path)  # pyright: ignore[reportPrivateUsage]

# examples/pydantic_ai_examples/weather_agent_gradio.py:8-8
from pydantic_ai import ToolCallPart, ToolReturnPart

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# examples/pydantic_ai_examples/ag_ui/__init__.py:27-27
app = FastAPI(title='Pydantic AI AG-UI server')

# pydantic_ai_slim/pydantic_ai/toolsets/wrapper.py:45-46
    def apply(self, visitor: Callable[[AbstractToolset[AgentDepsT]], None]) -> None:
        self.wrapped.apply(visitor)

# pydantic_ai_slim/pydantic_ai/ui/_web/app.py:50-107
async def _get_ui_html(html_source: str | Path | None = None) -> bytes:
    """Get UI HTML content from the specified source or default CDN.

    When html_source is provided, it is used directly.
    When html_source is None, fetches from the default CDN.

    Args:
        html_source: Path or URL for the chat UI HTML. Can be:
            - None: Uses the default CDN (cached locally)
            - A Path instance: Reads from the local file
            - A URL (http:// or https://): Fetches from the URL
            - A file path string: Reads from the local file
    """
    # Use default CDN with caching
    if html_source is None:
        cache_dir = _get_cache_dir()
        cache_file = cache_dir / f'{CHAT_UI_VERSION}.html'

        if cache_file.exists():
            return cache_file.read_bytes()

        async with httpx.AsyncClient() as client:
            response = await client.get(DEFAULT_HTML_URL)
            response.raise_for_status()
            content = response.content

        cache_file.write_bytes(content)
        return content

    # Handle Path instances
    if isinstance(html_source, Path):
        html_source = html_source.expanduser()
        if html_source.is_file():
            return html_source.read_bytes()
        raise FileNotFoundError(f'Local UI file not found: {html_source}')

    # Handle URLs with filesystem caching
    if html_source.startswith(('http://', 'https://')):
        cache_dir = _get_cache_dir()
        url_hash = hashlib.sha256(html_source.encode()).hexdigest()[:17]
        cache_file = cache_dir / f'url_{url_hash}.html'

        if cache_file.exists():
            return cache_file.read_bytes()

        async with httpx.AsyncClient() as client:
            response = await client.get(html_source)
            response.raise_for_status()
            content = response.content

        cache_file.write_bytes(content)
        return content

    # Handle local file paths (strings)
    local_path = Path(html_source).expanduser()
    if local_path.is_file():
        return local_path.read_bytes()
    raise FileNotFoundError(f'Local UI file not found: {html_source}')

# pydantic_ai_slim/pydantic_ai/models/wrapper.py:24-24
    wrapped: Model

# pydantic_ai_slim/pydantic_ai/toolsets/wrapper.py:20-20
    wrapped: AbstractToolset[AgentDepsT]

# examples/pydantic_ai_examples/ag_ui/api/agentic_chat.py:9-9
from pydantic_ai.ui.ag_ui.app import AGUIApp

# examples/pydantic_ai_examples/ag_ui/api/agentic_chat.py:9-9
from pydantic_ai.ui.ag_ui.app import AGUIApp

# examples/pydantic_ai_examples/ag_ui/api/agentic_chat.py:9-9
from pydantic_ai.ui.ag_ui.app import AGUIApp

# examples/pydantic_ai_examples/ag_ui/api/agentic_chat.py:9-9
from pydantic_ai.ui.ag_ui.app import AGUIApp

# examples/pydantic_ai_examples/ag_ui/api/agentic_chat.py:9-9
from pydantic_ai.ui.ag_ui.app import AGUIApp

# examples/pydantic_ai_examples/ag_ui/api/agentic_chat.py:9-9
from pydantic_ai.ui.ag_ui.app import AGUIApp

# examples/pydantic_ai_examples/slack_lead_qualifier/modal.py:36-41
def web_app():
    setup_logfire()

    from .app import app as _app

    return _app  ### [/web_app]

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/agent/abstract.py:6-6
from collections.abc import AsyncIterable, AsyncIterator, Awaitable, Callable, Iterator, Mapping, Sequence

# pydantic_ai_slim/pydantic_ai/embeddings/wrapper.py:27-27
    wrapped: EmbeddingModel

# pydantic_ai_slim/pydantic_ai/mcp.py:241-241
    tools_list_changed: bool = False

# pydantic_ai_slim/pydantic_ai/ui/vercel_ai/response_types.py:160-160
    approval_id: str

# pydantic_ai_slim/pydantic_ai/__init__.py:114-114
from .tools import DeferredToolRequests, DeferredToolResults, RunContext, Tool, ToolApproved, ToolDefinition, ToolDenied