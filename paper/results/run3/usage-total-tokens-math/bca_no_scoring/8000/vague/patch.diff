FILE: pydantic_ai_slim/pydantic_ai/embeddings/google.py
SEARCH:
                total_tokens += int(emb.statistics.token_count)  # pragma: lax no cover -- requires vertexai
REPLACE:
                total_tokens += int(emb.statistics.token_count) if emb.statistics.token_count else 0  # pragma: lax no cover -- requires vertexai

FILE: pydantic_ai_slim/pydantic_ai/models/xai.py
SEARCH:
    if extracted.input_tokens == 0 and usage_data['prompt_tokens']:
REPLACE:
    if extracted.input_tokens == 0 and usage_data.get('prompt_tokens', 0):
    
SEARCH:
    if extracted.output_tokens == 0 and usage_data['completion_tokens']:
REPLACE:
    if extracted.output_tokens == 0 and usage_data.get('completion_tokens', 0):
