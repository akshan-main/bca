FILE: pydantic_ai_slim/pydantic_ai/embeddings/google.py
SEARCH:
    total_tokens = 0
REPLACE:
    total_tokens = response.embeddings[0].statistics.token_count if response.embeddings and response.embeddings[0].statistics else 0

FILE: pydantic_ai_slim/pydantic_ai/embeddings/result.py
SEARCH:
    usage: RequestUsage = field(default_factory=RequestUsage)
REPLACE:
    usage: RequestUsage = field(default_factory=lambda: RequestUsage(input_tokens=0, output_tokens=0))

FILE: pydantic_ai_slim/pydantic_ai/messages.py
SEARCH:
        return cls(parts=[UserPromptPart(user_prompt)], instructions=instructions)
REPLACE:
        return cls(parts=[UserPromptPart(user_prompt)], instructions=instructions, usage=RequestUsage(input_tokens=0, output_tokens=0))
