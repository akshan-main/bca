# src/cegraph/graph/query.py:231-246
    def get_file_symbols(self, file_path: str) -> list[dict]:
        """Get all symbols defined in a file."""
        file_node = f"{file_path}"
        if not self.graph.has_node(file_node):
            return []

        symbols = []
        for succ in self.graph.successors(file_node):
            data = self.graph.nodes.get(succ, {})
            if data.get("type") == "symbol":
                symbols.append({
                    "id": succ,
                    **{k: v for k, v in data.items() if k != "type"},
                })

        return sorted(symbols, key=lambda s: s.get("line_start", 0))

# src/cegraph/agent/loop.py:14-14
from typing import Any, AsyncIterator, Callable

# src/cegraph/config.py:8-8
from typing import Any

# src/cegraph/context/_native.py:20-20
from typing import Any

# src/cegraph/context/models.py:6-6
from typing import Any

# src/cegraph/github/diff_parser.py:14-14
from typing import Any

# src/cegraph/github/impact_bot.py:24-24
from typing import Any

# src/cegraph/github/renderer.py:13-13
from typing import Any

# src/cegraph/llm/anthropic_provider.py:6-6
from typing import Any, AsyncIterator

# src/cegraph/llm/base.py:6-6
from typing import Any, AsyncIterator

# src/cegraph/llm/openai_provider.py:6-6
from typing import Any, AsyncIterator

# src/cegraph/map/app.py:14-14
from typing import Any

# src/cegraph/mcp/server.py:22-22
from typing import Any

# src/cegraph/tools/definitions.py:9-9
from typing import Any

# src/cegraph/tools/registry.py:6-6
from typing import Any, Callable

# examples/demo.py:10-10
from cegraph.graph.query import GraphQuery

# paper/experiments/ablation.py:23-23
from cegraph.graph.query import GraphQuery

# paper/experiments/baselines.py:30-30
from cegraph.graph.query import GraphQuery

# paper/experiments/benchmark.py:57-57
from cegraph.graph.query import GraphQuery

# src/cegraph/context/engine.py:49-49
from cegraph.graph.query import GraphQuery

# src/cegraph/graph/__init__.py:5-5
from cegraph.graph.query import GraphQuery

# src/cegraph/tools/definitions.py:13-13
from cegraph.graph.query import GraphQuery

# tests/test_context.py:17-17
from cegraph.graph.query import GraphQuery

# tests/test_graph.py:11-11
from cegraph.graph.query import GraphQuery

# tests/test_mcp.py:11-11
from cegraph.graph.query import GraphQuery

# tests/test_tools.py:10-10
from cegraph.graph.query import GraphQuery

# src/cegraph/github/diff_parser.py:116-177
def get_changed_symbols(
    root: Path, graph, file_diffs: list[FileDiff]
) -> list[ChangedSymbol]:
    """Map diff hunks to symbols using the knowledge graph.

    For each changed line range, find which symbols in the graph
    overlap with those lines.
    """
    changed: list[ChangedSymbol] = []
    seen = set()

    for fd in file_diffs:
        if fd.status == "deleted":
            # All symbols in deleted file are affected
            for node_id, data in graph.nodes(data=True):
                if data.get("type") == "symbol" and data.get("file_path") == fd.path:
                    key = (data.get("name"), fd.path)
                    if key not in seen:
                        changed.append(ChangedSymbol(
                            name=data.get("name", ""),
                            qualified_name=data.get("qualified_name", ""),
                            kind=data.get("kind", ""),
                            file_path=fd.path,
                            line_start=data.get("line_start", 0),
                            line_end=data.get("line_end", 0),
                            change_type="deleted",
                        ))
                        seen.add(key)
            continue

        # For modified/added files, find overlapping symbols
        ranges = fd.changed_line_ranges
        for node_id, data in graph.nodes(data=True):
            if data.get("type") != "symbol":
                continue
            if data.get("file_path") != fd.path:
                continue

            sym_start = data.get("line_start", 0)
            sym_end = data.get("line_end", 0)

            # Check if any hunk overlaps with this symbol
            for r_start, r_end in ranges:
                if sym_start <= r_end and sym_end >= r_start:
                    key = (data.get("name"), fd.path)
                    if key not in seen:
                        overlap = min(sym_end, r_end) - max(sym_start, r_start)
                        change_type = "added" if fd.status == "added" else "modified"
                        changed.append(ChangedSymbol(
                            name=data.get("name", ""),
                            qualified_name=data.get("qualified_name", ""),
                            kind=data.get("kind", ""),
                            file_path=fd.path,
                            line_start=sym_start,
                            line_end=sym_end,
                            change_type=change_type,
                            lines_changed=max(0, overlap),
                        ))
                        seen.add(key)
                    break

    return changed

# src/cegraph/context/engine.py:349-427
    def _find_seeds(
        self, entities: list[dict], focus_files: list[str] | None = None
    ) -> list[dict]:
        """Find seed symbols in the graph matching extracted entities."""
        seeds: list[dict] = []
        seen_ids = set()

        for entity in entities:
            name = entity["name"]
            confidence = entity["confidence"]

            if entity["type"] == "file":
                file_node = f"file::{name}"
                if self.graph.has_node(file_node):
                    for succ in self.graph.successors(file_node):
                        data = self.graph.nodes.get(succ, {})
                        if data.get("type") == "symbol" and succ not in seen_ids:
                            kind_w = _KIND_WEIGHTS.get(data.get("kind", ""), 0.5)
                            seeds.append({
                                "symbol_id": succ,
                                "score": confidence * kind_w,
                                "reason": f"in file '{name}'",
                            })
                            seen_ids.add(succ)
            else:
                matches = self.query.find_symbol(name)
                for sid in matches:
                    if sid in seen_ids:
                        continue
                    data = self.graph.nodes.get(sid, {})
                    if data.get("type") != "symbol":
                        continue
                    kind = data.get("kind", "")
                    sym_name = data.get("name", "")

                    if sym_name.lower() == name.lower():
                        match_score = 1.0
                    elif name.lower() in sym_name.lower():
                        match_score = 0.7
                    else:
                        match_score = 0.4

                    kind_w = _KIND_WEIGHTS.get(kind, 0.5)
                    score = confidence * match_score * kind_w

                    if kind == "import" and score < 0.3:
                        continue

                    seeds.append({
                        "symbol_id": sid,
                        "score": score,
                        "reason": f"matches '{name}'",
                    })
                    seen_ids.add(sid)

        if focus_files:
            for fp in focus_files:
                file_node = f"file::{fp}"
                if self.graph.has_node(file_node):
                    for succ in self.graph.successors(file_node):
                        data = self.graph.nodes.get(succ, {})
                        if data.get("type") == "symbol" and succ not in seen_ids:
                            kind_w = _KIND_WEIGHTS.get(data.get("kind", ""), 0.5)
                            seeds.append({
                                "symbol_id": succ,
                                "score": 0.8 * kind_w,
                                "reason": f"in focus file '{fp}'",
                            })
                            seen_ids.add(succ)

        seeds.sort(key=lambda x: x["score"], reverse=True)

        # Cap low-confidence keyword seeds to avoid noise explosion.
        # Keep all high-confidence seeds (>= 0.5), but limit keywords to 5.
        high = [s for s in seeds if s["score"] >= 0.5]
        low = [s for s in seeds if s["score"] < 0.5]
        seeds = high + low[:5]

        return seeds

# src/cegraph/context/_native.py:269-276
    def topological_sort(self, nodes: list[int]) -> list[int]:
        """Topological sort a subset of nodes."""
        n = len(nodes)
        c_nodes = (ctypes.c_int32 * n)(*nodes)
        out_order = (ctypes.c_int32 * n)()

        count = self._lib.cag_topological_sort(self._handle, c_nodes, n, out_order)
        return [out_order[i] for i in range(count)]

# src/cegraph/github/diff_parser.py:38-43
    def changed_line_ranges(self) -> list[tuple[int, int]]:
        """Get ranges of changed lines in the new file."""
        ranges = []
        for hunk in self.hunks:
            ranges.append((hunk.new_start, hunk.new_start + hunk.new_count))
        return ranges

# src/cegraph/tools/definitions.py:468-470
def get_tool_definitions() -> list[ToolDefinition]:
    """Get all built-in tool definitions."""
    return _TOOL_DEFINITIONS.copy()