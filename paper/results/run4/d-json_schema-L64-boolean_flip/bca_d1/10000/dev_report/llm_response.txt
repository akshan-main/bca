```
FILE: pydantic_ai_slim/pydantic_ai/_json_schema.py
SEARCH:
        if not self.prefer_inlined_defs or self.defs:
            handled['$defs'] = {k: self._handle(v) for k, v in self.defs.items()}
REPLACE:
        if not self.prefer_inlined_defs or self.defs:
            handled['$defs'] = {k: self._handle(v) for k, v in self.defs.items() if v is not None}
```