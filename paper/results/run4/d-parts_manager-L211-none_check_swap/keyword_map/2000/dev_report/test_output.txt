1.1, hypothesis-6.148.2, asyncio-1.3.0, rich-0.2.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 34 items

tests/test_parts_manager.py .........................F

=================================== FAILURES ===================================
_____ test_handle_thinking_delta_no_vendor_id_with_existing_thinking_part ______

    def test_handle_thinking_delta_no_vendor_id_with_existing_thinking_part():
        manager = ModelResponsePartsManager()
    
        # Add a thinking part first
>       event = next(manager.handle_thinking_delta(vendor_part_id='first', content='initial thought', signature=None))

tests/test_parts_manager.py:578: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
pydantic_ai_slim/pydantic_ai/_parts_manager.py:252: in handle_thinking_delta
    provider_name=self._resolve_provider_name(existing_thinking_part, provider_name),
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ModelResponsePartsManager(_parts=[], _vendor_id_to_part_index={})
existing_part = None, provider_name = None

    def _resolve_provider_name(
        self, existing_part: ModelResponsePart | ToolCallPartDelta, provider_name: str | None
    ) -> str | None:
        """Return the provider name if it has not been set on previous parts."""
>       if existing_part.provider_name is None or provider_name != existing_part.provider_name:
E       AttributeError: 'NoneType' object has no attribute 'provider_name'

pydantic_ai_slim/pydantic_ai/_parts_manager.py:490: AttributeError
=========================== short test summary info ============================
FAILED tests/test_parts_manager.py::test_handle_thinking_delta_no_vendor_id_with_existing_thinking_part
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
========================= 1 failed, 25 passed in 0.48s =========================

/Users/akshankrithick/anaconda3/envs/vvenv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:247: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))