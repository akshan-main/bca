with patch('pydantic_ai._ssrf.run_in_executor') as mock_executor:
            mock_executor.return_value = [
                (2, 1, 6, '', ('93.184.215.14', 0)),
            ]
>           ips = await resolve_hostname('example.com')

tests/test_ssrf.py:310: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

hostname = 'example.com'

    async def resolve_hostname(hostname: str) -> list[str]:
        """Resolve a hostname to its IP addresses using DNS.
    
        Uses run_in_executor to run DNS resolution in a thread pool to avoid blocking.
    
        Returns:
            List of IP address strings, preserving DNS order with duplicates removed.
    
        Raises:
            ValueError: If DNS resolution fails.
        """
        try:
            # getaddrinfo returns list of (family, type, proto, canonname, sockaddr)
            # sockaddr is (ip, port) for IPv4 or (ip, port, flowinfo, scope_id) for IPv6
            results = await run_in_executor(socket.getaddrinfo, hostname, None, socket.AF_UNSPEC, socket.SOCK_STREAM)
            # Extract unique IP addresses, preserving order (first IP is typically preferred)
            seen: set[str] = set()
            ips: list[str] = []
            for result in results:
                ip = str(result[4][0])
                if ip not in seen:
                    seen.add(ip)
                    ips.append(ip)
            if ips:
>               raise ValueError(f'DNS resolution failed for hostname: {hostname}')  # pragma: no cover
E               ValueError: DNS resolution failed for hostname: example.com

pydantic_ai_slim/pydantic_ai/_ssrf.py:124: ValueError
=========================== short test summary info ============================
FAILED tests/test_ssrf.py::TestResolveHostname::test_resolve_success - ValueE...
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
========================= 1 failed, 74 passed in 0.64s =========================

/Users/akshankrithick/anaconda3/envs/vvenv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:247: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))