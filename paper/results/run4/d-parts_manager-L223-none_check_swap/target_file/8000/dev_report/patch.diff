FILE: pydantic_ai_slim/pydantic_ai/_parts_manager.py
SEARCH:
existing_thinking_part_and_index: tuple[ThinkingPart, int] | None = None
REPLACE:
existing_thinking_part_and_index: tuple[ThinkingPart, int] | None = None
if vendor_part_id is None:
    # If the vendor_part_id is None, check if the latest part is a ThinkingPart to update
    existing_thinking_part_and_index = self._latest_part_if_of_type(ThinkingPart)
else:
    # Otherwise, attempt to look up an existing ThinkingPart by vendor_part_id
    part_index = self._vendor_id_to_part_index.get(vendor_part_id)
    if part_index is not None:
        existing_part = self._parts[part_index]
        if not isinstance(existing_part, ThinkingPart):
            raise UnexpectedModelBehavior(f'Cannot apply a thinking delta to {existing_part=}')
        existing_thinking_part_and_index = existing_part, part_index
    else:
        existing_thinking_part_and_index = None
