FILE: pydantic_ai_slim/pydantic_ai/retries.py
SEARCH:
    def handle_request(self, request: Request) -> Response:
        """Handle an HTTP request with retry logic.
        
        Args:
            request: The HTTP request to handle.
        
        Returns:
            The HTTP response.
        
        Raises:
            RuntimeError: If the retry controller did not make any attempts.
            Exception: Any exception raised by the wrapped transport or validation function.
        """
        
        @retry(**self.config)
        def handle_request(req: Request) -> Response:
            response = self.wrapped.handle_request(req)
            
            # this is normally set by httpx _after_ calling this function, but we want the request in the validator:
            response.request = req
            
            if self.validate_response:
                try:
                    self.validate_response(response)
                except Exception:
                    response.close()
                    raise
            return response
        
        return handle_request(request)
        
    def close(self) -> None:
        self.wrapped.close()  # pragma: no cover
REPLACE:
    def handle_request(self, request: Request) -> Response:
        """Handle an HTTP request with retry logic.
        
        Args:
            request: The HTTP request to handle.
        
        Returns:
            The HTTP response.
        
        Raises:
            RuntimeError: If the retry controller did not make any attempts.
            Exception: Any exception raised by the wrapped transport or validation function.
        """
        
        @retry(**self.config)
        def handle_request(req: Request) -> Response:
            response = self.wrapped.handle_request(req)
            
            # this is normally set by httpx _after_ calling this function, but we want the request in the validator:
            response.request = req
            
            if self.validate_response:
                try:
                    self.validate_response(response)
                except Exception:
                    response.close()
                    raise
            return response
        
        return handle_request(request)

    def close(self) -> None:
        self.wrapped.close()  # pragma: no cover
