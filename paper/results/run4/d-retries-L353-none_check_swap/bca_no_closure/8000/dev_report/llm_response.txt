```
FILE: pydantic_ai_slim/pydantic_ai/retries.py
SEARCH:
        exc = state.outcome.exception() if state.outcome else None
REPLACE:
        exc = state.outcome.exception() if state.outcome else None
        state.attempt_number = state.attempt_number if hasattr(state, 'attempt_number') else 1
```

```
FILE: tests/test_tenacity.py
SEARCH:
        retry_state.outcome = None
REPLACE:
        retry_state.outcome = Mock()
```