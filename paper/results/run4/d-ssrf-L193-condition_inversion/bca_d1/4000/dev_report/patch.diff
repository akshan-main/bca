FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    def build_url_with_ip(resolved: ResolvedUrl) -> str:
        ip = resolved.resolved_ip
        if resolved.port == 80 and not resolved.is_https:
            return f'http://{ip}{resolved.path}'
        elif resolved.port == 443 or resolved.is_https:
            return f'https://{ip}{resolved.path}'
        return f'http://{ip}:{resolved.port}{resolved.path}'
REPLACE:
    def build_url_with_ip(resolved: ResolvedUrl) -> str:
        ip = resolved.resolved_ip
        if resolved.port == 80 and not resolved.is_https:
            return f'http://{ip}{resolved.path}'
        elif resolved.port == 443 or resolved.is_https:
            return f'https://{ip}{resolved.path}'
        return f'http://{ip}:{resolved.port}{resolved.path}' if ':' in ip else f'http://{ip}{resolved.path}'
