```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    return hostname, path, port, is_https
REPLACE:
    return hostname if not is_ipv6(hostname) else hostname[1:-1], path, port, is_https
```

```
FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
def extract_host_and_port(url: str) -> tuple[str, str, int, bool]:
REPLACE:
def extract_host_and_port(url: str) -> tuple[str, str, int, bool]:
    from ipaddress import ip_address, AddressValueError
    def is_ipv6(hostname: str) -> bool:
        try:
            ip_address(hostname)
            return ':' in hostname
        except AddressValueError:
            return False
```