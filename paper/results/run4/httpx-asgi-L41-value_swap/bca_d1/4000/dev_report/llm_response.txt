```
FILE: tests/test_asgi.py
SEARCH:
async def read_body(scope, receive, send):
    nonlocal disconnect

    status = 200
    headers = [(b"content-type", "text/plain")]

    await send(
        {"type": "http.response.start", "status": status, "headers": headers}
    )
    more_body = True
    while more_body:
        message = await receive()
        more_body = message.get("more_body", False)

    await send({"type": "http.response.body", "body": b"", "more_body": False})

REPLACE:
async def read_body(scope, receive, send):
    nonlocal disconnect

    status = 200
    headers = [(b"content-type", "text/plain")]

    await send(
        {"type": "http.response.start", "status": status, "headers": headers}
    )
    more_body = True
    while more_body:
        message = await receive()
        more_body = message.get("more_body", False)

    await send({"type": "http.response.body", "body": b""})
    disconnect_message = await receive()
    disconnect = disconnect_message.get("type") == "http.disconnect"
```