FILE: pydantic_ai_slim/pydantic_ai/_ssrf.py
SEARCH:
    def build_url_with_ip(resolved: ResolvedUrl) -> str:
        scheme = 'https' if resolved.is_https else 'http'
        return f"{scheme}://{resolved.resolved_ip}:{resolved.port}{resolved.path}"
REPLACE:
    def build_url_with_ip(resolved: ResolvedUrl) -> str:
        scheme = 'https' if resolved.is_https else 'http'
        return f"{scheme}://{resolved.resolved_ip}{resolved.path}" if resolved.port == 80 and not resolved.is_https else f"{scheme}://{resolved.resolved_ip}:{resolved.port}{resolved.path}"
