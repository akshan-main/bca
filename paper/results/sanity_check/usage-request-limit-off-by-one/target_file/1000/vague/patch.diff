FILE: pydantic_ai_slim/pydantic_ai/usage.py
SEARCH:
from .exceptions import UsageLimitExceeded
REPLACE:
from .exceptions import UsageLimitExceeded, ValueError

FILE: pydantic_ai_slim/pydantic_ai/usage.py
SEARCH:
@dataclass(repr=False, kw_only=True)
REPLACE:
@dataclass(repr=False, kw_only=True, frozen=True)

FILE: pydantic_ai_slim/pydantic_ai/usage.py
SEARCH:
    def has_values(self) -> bool:
        """Whether any values are set and non-zero."""
        return any(dataclasses.asdict(self).values())
REPLACE:
    def has_values(self, request_limit: int = 0) -> bool:
        """Whether any values are set and non-zero, and respects request limit."""
        if request_limit < 0:
            raise ValueError("request_limit must be non-negative")
        return any(dataclasses.asdict(self).values()) and request_limit > 0
