FILE: pydantic_ai_slim/pydantic_ai/embeddings/google.py
SEARCH:
    return RequestUsage(input_tokens=total_tokens)
REPLACE:
    return RequestUsage(input_tokens=total_tokens, total_tokens=total_tokens)

FILE: pydantic_ai_slim/pydantic_ai/embeddings/voyageai.py
SEARCH:
    return RequestUsage(input_tokens=total_tokens)
REPLACE:
    return RequestUsage(input_tokens=total_tokens, total_tokens=total_tokens)

FILE: pydantic_ai_slim/pydantic_ai/models/xai.py
SEARCH:
    if extracted.input_tokens == 0 and usage_data['prompt_tokens']:
        extracted.input_tokens = usage_data['prompt_tokens']
    if extracted.output_tokens == 0 and usage_data['completion_tokens']:
        extracted.output_tokens = usage_data['completion_tokens']
REPLACE:
    if extracted.input_tokens == 0 and usage_data['prompt_tokens']:
        extracted.input_tokens = usage_data['prompt_tokens']
    if extracted.output_tokens == 0 and usage_data['completion_tokens']:
        extracted.output_tokens = usage_data['completion_tokens']
    if extracted.total_tokens == 0:
        extracted.total_tokens = extracted.input_tokens + extracted.output_tokens

FILE: tests/models/test_xai.py
SEARCH:
    assert result.usage() == snapshot(RunUsage(input_tokens=20, output_tokens=10, requests=1))
REPLACE:
    assert result.usage() == snapshot(RunUsage(input_tokens=20, output_tokens=10, total_tokens=30, requests=1))
